<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 대시보드</title>
    <link rel="stylesheet" href="/css/baseball-theme.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="/icons/icon.png">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-logo">
                <h1><i class="fas fa-baseball-ball"></i> 관리자 대시보드</h1>
                <div class="admin-controls" style="margin:8px 0;">
                    <span id="admin-user-info" style="color: #27ae60; font-weight: bold;"><i class="fas fa-user-shield"></i> 관리자 로그인됨</span>
                    <button id="admin-logout-btn" style="margin-left: 10px; padding: 5px 10px; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;"><i class="fas fa-sign-out-alt"></i> 로그아웃</button>
                </div>
                <div class="subtitle">
                    <span class="kbo-style">여기 회장들 안주만들어 먹다가 둘다 100kg가 넘었대</span>
                    <p>실시간 주문 현황 관리</p>
                </div>
            </div>

            <!-- 전체 주문 관리 섹션 -->
            <section style="margin:16px 0; padding:16px; border:2px solid #2ecc71; border-radius:8px; background-color:#f8f9fa;">
                <h3><i class="fas fa-list"></i> 전체 주문 관리</h3>
                <p style="color:#666; margin-bottom:12px;">모든 주문을 페이지별로 조회하고 관리할 수 있습니다.</p>
                
                <!-- 필터 및 설정 -->
                <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:16px; padding:12px; background:white; border-radius:6px;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <label for="orders-per-page" style="font-weight:bold;">페이지당:</label>
                        <select id="orders-per-page" style="padding:4px 8px; border:1px solid #ddd; border-radius:4px;">
                            <option value="10" selected>10개</option>
                            <option value="20">20개</option>
                            <option value="50">50개</option>
                        </select>
                    </div>
                    
                    <div style="display:flex; align-items:center; gap:8px;">
                        <label for="status-filter" style="font-weight:bold;">상태:</label>
                        <select id="status-filter" style="padding:4px 8px; border:1px solid #ddd; border-radius:4px;">
                            <option value="">전체</option>
                            <option value="PENDING">입금 대기</option>
                            <option value="CONFIRMED">입금 확인</option>
                            <option value="IN_PROGRESS">조리중</option>
                            <option value="SERVED">서빙 완료</option>
                            <option value="CANCELED">취소됨</option>
                        </select>
                    </div>
                    
                    <button id="refresh-all-orders" style="padding:8px 16px; background:#3498db; color:white; border:none; border-radius:4px; cursor:pointer;">
                        <i class="fas fa-sync"></i> 새로고침
                    </button>
                </div>

                <!-- 주문 목록 컨테이너 -->
                <div id="all-orders-container" style="margin-top:16px;">
                    <div style="text-align:center; color:#666; padding:20px;">
                        <i class="fas fa-spinner fa-spin" style="font-size:2em; margin-bottom:8px;"></i><br>
                        주문 목록을 불러오는 중...
                    </div>
                </div>

                <!-- 페이지네이션 -->
                <div id="pagination-controls" style="display:flex; justify-content:center; align-items:center; gap:12px; margin-top:16px; padding:12px;">
                    <button id="prev-page-btn" style="padding:8px 16px; background:#95a5a6; color:white; border:none; border-radius:4px; cursor:pointer;" disabled>
                        <i class="fas fa-chevron-left"></i> 이전
                    </button>
                    <span id="page-info" style="font-weight:bold; color:#2c3e50;">페이지 1</span>
                    <button id="next-page-btn" style="padding:8px 16px; background:#95a5a6; color:white; border:none; border-radius:4px; cursor:pointer;" disabled>
                        다음 <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>

            <!-- 주문 관리 섹션 -->
            <section style="margin:16px 0; padding:16px; border:2px solid #3498db; border-radius:8px; background-color:#f8f9fa;">
                <h3><i class="fas fa-search"></i> 주문 조회 및 상태 관리</h3>
                <p style="color:#666; margin-bottom:12px;">주문 번호를 입력하여 주문을 조회하고 상태를 변경할 수 있습니다.</p>
                
                <!-- 주문 플로우 표시 -->
                <div style="background:white; padding:12px; border-radius:6px; margin-bottom:16px; border-left:4px solid #3498db;">
                    <h4 style="margin:0 0 8px 0; color:#2c3e50;"><i class="fas fa-route"></i> 주문 처리 플로우</h4>
                    <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; font-size:0.9em;">
                        <span style="padding:4px 8px; background:#f39c12; color:white; border-radius:12px; font-weight:bold;">💰 PENDING</span>
                        <i class="fas fa-arrow-right" style="color:#666;"></i>
                        <span style="padding:4px 8px; background:#27ae60; color:white; border-radius:12px; font-weight:bold;">💳 CONFIRMED</span>
                        <i class="fas fa-arrow-right" style="color:#666;"></i>
                        <span style="padding:4px 8px; background:#3498db; color:white; border-radius:12px; font-weight:bold;">👨‍🍳 IN_PROGRESS</span>
                        <i class="fas fa-arrow-right" style="color:#666;"></i>
                        <span style="padding:4px 8px; background:#2ecc71; color:white; border-radius:12px; font-weight:bold;">🍽️ SERVED</span>
                        <div style="margin-left:16px; color:#e74c3c; font-weight:bold;">
                            <i class="fas fa-times-circle"></i> CANCELED (언제든지 가능)
                        </div>
                    </div>
                </div>
                
                <form id="order-search-form" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:16px;">
                    <input id="order-search-id" type="number" placeholder="주문 번호 입력 (예: 123)" min="1" required style="padding:8px; border:1px solid #ddd; border-radius:4px; min-width:200px;" />
                    <button type="submit" style="padding:8px 16px; background:#3498db; color:white; border:none; border-radius:4px; cursor:pointer;">
                        <i class="fas fa-search"></i> 조회
                    </button>
                </form>
                
                <div id="order-inspect" style="margin-top:12px;">
                    <div style="text-align:center; color:#666; padding:20px; border:1px dashed #ddd; border-radius:8px;">
                        <i class="fas fa-info-circle" style="font-size:2em; margin-bottom:8px;"></i><br>
                        주문 번호를 입력하고 조회 버튼을 클릭하세요.
                    </div>
                </div>
            </section>

            <div class="baseball-scoreboard">
                <div class="score-info">
                    <span class="inning"><i class="fas fa-stadium"></i> 운영 상황</span>
                    <span class="score">대기팀: <span id="waiting-teams">0</span>팀</span>
                </div>
                <div class="notification-controls">
                    <button id="notification-toggle" class="notification-btn" title="알림 설정">
                        <i class="fas fa-bell"></i> 알림 ON
                    </button>
                    <button id="test-sound-btn" class="notification-btn" title="소리 테스트">
                        <i class="fas fa-volume-up"></i> 테스트
                    </button>
                    <a href="kitchen.html" target="_blank" class="notification-btn" title="주방 디스플레이">
                        <i class="fas fa-utensils"></i> 주방
                    </a>
                </div>
            </div>
            
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-orders">0</div>
                    <div class="stat-label">총 주문</div>
                </div>
                <div class="stat-card payment-pending-stat">
                    <div class="stat-number" id="payment-pending-orders">0</div>
                    <div class="stat-label"><i class="fas fa-credit-card"></i> 입금대기</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pending-orders">0</div>
                    <div class="stat-label">준비중</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completed-orders">0</div>
                    <div class="stat-label">완료</div>
                </div>
            </div>

            <!-- 매출 현황 섹션 -->
            <div class="sales-dashboard">
                <div class="sales-card">
                    <div class="sales-header">💰 오늘 매출</div>
                    <div class="sales-amount" id="today-sales">0원</div>
                    <div class="sales-detail">
                        <span>완료된 주문: <span id="today-completed">0</span>건</span>
                        <span>평균 주문금액: <span id="avg-order">0</span>원</span>
                    </div>
                </div>
                <div class="sales-card">
                    <div class="sales-header">⏰ 실시간 현황</div>
                    <div class="current-time" id="current-time">--:--</div>
                    <div class="sales-detail">
                        <span>시간당 주문: <span id="hourly-orders">0</span>건</span>
                        <span>예상 대기시간: <span id="estimated-wait">-</span></span>
                    </div>
                </div>
                <div class="sales-card">
                    <div class="sales-header">🔥 인기 메뉴</div>
                    <div class="top-menu" id="top-selling-menu">-</div>
                    <div class="sales-detail">
                        <span id="top-menu-count">0건 주문됨</span>
                        <span id="menu-percentage">전체의 0%</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 재고 관리 섹션 -->
        <section class="inventory-section">
            <h2><i class="fas fa-boxes"></i> 메뉴별 재고 현황</h2>
            <div id="inventory-list">
                <!-- 메뉴별 재고가 여기에 표시됩니다 -->
            </div>
        </section>

        <main id="admin-dashboard">
            <!-- 실시간 주문이 여기에 표시됩니다. -->
        </main>
    </div>

    <!-- Firebase SDK (v8) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <!-- Firebase 설정 및 관리자 로직 -->
    <script src="/js/firebase-config.js"></script>
    <script src="/js/config.js"></script>
    <script type="module" src="/js/admin.js"></script>
</body>
</html>